# postgres-transaction
A wrapper of SQL-transaction for postgres (pg)

# Installation

This module is installed via npm:

``` bash
$ npm install postgres-transaction
```

## Example

### Creation
``` js
var pg = require('pg');
var pgTransaction = require('postgres-transaction');
var connectionString = "postgres://username:password@hostname/dbname"
pg.connect(connectionString, didConnect);

function didConnect(err, client, done) {
  pgTransaction(client, done, didCreateTransaction);
}

function didCreateTransaction(err, transaction) {
  //if no error, you succesfully created a transaction
}
```

### Query
Use commit after querying the DB will persits all your insert/updade/delte/etc querys.
``` js
function didCreateTransaction(err, transaction) {
  //It is recommend to perform a query with a prepared statement
  var preparedStatement = {
		text: "INSERT INTO Train (id, name) VALUES (2, $1);",
		values: ["Transrapid"],
		name: 'CreateTrain'
	};
	transaction.query(preparedStatement, didFinishQuery);
  
  //but is is also possible as a simple querystring:
  var query = "INSERT INTO Train (id, name) VALUES (2, 'Transrapid')";
  transaction.query(query, didFinishQuery);
  
  //Commit after you did all query for this transaction
  transaction.commit(didCommit);
}

```

### Rollback
Use rollback after querying the DB will cancel all your insert/updade/delte/etc querys.
``` js
  transaction.rollback(didRollback);
}

```
