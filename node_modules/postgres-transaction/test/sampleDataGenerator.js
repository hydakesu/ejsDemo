var pg = require("pg");
var connectionString = "postgres://postgres:@localhost/travis_ci_test";
module.exports = (function() {

	
	function generate(callback) {
		generateScheme(function(){
			generateData(callback);
		});
	}
	
	function generateScheme(callback){
		pg.connect(connectionString, function(err, client, done){
			
			client.query("CREATE TABLE Train (id BIGSERIAL NOT NULL, name varchar(255) NOT NULL, PRIMARY KEY (id));", function(err, result) {
			
				callback()
			});
		});
	}
	
	function generateData(callback){
		pg.connect(connectionString, function(err, client, done){
			client.query("INSERT INTO Train (id, name) VALUES (1, 'ICE');", callback);
		});
	}
	
	function teardown(callback) {
		pg.connect(connectionString, function(err, client, done){
			client.query("DROP TABLE Train CASCADE;", callback);
		});
	}
	
	 return {
		generate: generate,
		teardown: teardown
	};
})();